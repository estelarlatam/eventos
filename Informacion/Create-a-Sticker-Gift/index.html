<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear un Regalo de Sticker - Evento Especial</title>
    <style>
        /* [Mismo CSS que antes - se mantiene igual] */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #ffd4c7 0%, #ffcfc4 50%, #ffd6cc 100%);
            min-height: 100vh;
            color: #333;
            padding-bottom: 2rem;
        }

        .countdown-banner {
            background: rgba(255, 255, 255, 0.9);
            text-align: center;
            padding: 0.75rem;
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .countdown-time {
            font-weight: 700;
            color: #e74c3c;
        }

        .event-ended {
            color: #999;
            font-weight: 600;
        }

        .hero-banner {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            background: #ffd4c7;
        }

        .hero-banner img {
            width: 100%;
            height: auto;
            display: block;
        }

        .tabs-container {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 40px;
            z-index: 99;
            border-bottom: 1px solid rgba(255,255,255,0.5);
        }

        .tabs {
            display: flex;
            max-width: 800px;
            margin: 0 auto;
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            background: transparent;
            border: none;
            font-size: 1rem;
        }

        .tab.active {
            color: #333;
            border-bottom-color: #ff6b9d;
            background: rgba(255,255,255,0.8);
        }

        .tab:hover {
            background: rgba(255,255,255,0.4);
        }

        .content-wrapper {
            max-width: 800px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.6);
            overflow: hidden;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }

        .card-subtitle {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-text {
            color: #555;
            line-height: 1.6;
            font-size: 0.95rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .awards-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .awards-header {
            background: linear-gradient(135deg, #7c7fd6 0%, #5a5fc7 100%);
            color: white;
            text-align: center;
            padding: 1.25rem;
        }

        .awards-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .awards-header .subtitle {
            font-size: 1.1rem;
            font-weight: 600;
            opacity: 0.95;
            margin-top: 0.25rem;
        }

        .awards-content {
            padding: 1.5rem;
        }

        .gift-image-container {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .gift-image-container img {
            width: 100%;
            height: auto;
            display: block;
        }

        .gift-examples-real {
            width: 100%;
            max-width: 300px;
            margin: 1rem auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .gift-examples-real img {
            width: 100%;
            height: auto;
            display: block;
        }

        .disclaimer {
            font-size: 0.8rem;
            color: #888;
            text-align: center;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .info-table th {
            background: linear-gradient(135deg, #7c7fd6 0%, #5a5fc7 100%);
            color: white;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
        }

        .info-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
            color: #555;
        }

        .info-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .info-table tr:hover {
            background: #f0f0f0;
        }

        .schedule-item {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .schedule-item::before {
            content: '‚óÜ';
            position: absolute;
            left: 0;
            color: #3498db;
            font-size: 0.8rem;
        }

        .schedule-title {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .schedule-date {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .schedule-note {
            color: #888;
            font-size: 0.85rem;
            margin-top: 0.25rem;
            font-style: italic;
        }

        .details-list {
            list-style: none;
            padding: 0;
        }

        .details-list li {
            padding: 0.5rem 0;
            padding-left: 1rem;
            position: relative;
            color: #555;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .details-list li::before {
            content: '-';
            position: absolute;
            left: 0;
            color: #999;
        }

        .section-header {
            font-weight: 700;
            color: #333;
            margin: 1.5rem 0 0.75rem 0;
            font-size: 0.95rem;
        }

        .link-text {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }

        .link-text:hover {
            text-decoration: underline;
        }

        .accordion-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 1rem;
        }

        .accordion-header {
            background: #fff;
            color: #e74c3c;
            padding: 1rem;
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
            border-bottom: 1px solid #eee;
        }

        .accordion-item {
            border-bottom: 1px solid #eee;
        }

        .accordion-trigger {
            width: 100%;
            padding: 1rem 1.25rem;
            background: #f8f9fa;
            border: none;
            text-align: left;
            font-size: 0.95rem;
            font-weight: 600;
            color: #2c3e50;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .accordion-trigger:hover {
            background: #e9ecef;
        }

        .accordion-trigger::before {
            content: '‚óá';
            color: #3498db;
            margin-right: 0.5rem;
        }

        .accordion-icon {
            transition: transform 0.3s;
            color: #999;
        }

        .accordion-item.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: #fff;
        }

        .accordion-item.active .accordion-content {
            max-height: 500px;
        }

        .accordion-body {
            padding: 1rem 1.25rem;
            color: #555;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .rankings-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #333;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .participant-count {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            color: #666;
            font-weight: 400;
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }

        .user-ranking-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-rank-position {
            font-size: 1.25rem;
            font-weight: 700;
            color: #333;
            min-width: 60px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.5rem;
            overflow: hidden;
            flex-shrink: 0;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 700;
            color: #2c3e50;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .user-name a {
            color: #2c3e50;
            text-decoration: none;
        }

        .user-name a:hover {
            color: #7c7fd6;
            text-decoration: underline;
        }

        .verified-badge {
            color: #3498db;
            font-size: 0.9rem;
        }

        .user-score {
            color: #3498db;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .ranking-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s;
        }

        .ranking-item:hover {
            background: #f8f9fa;
        }

        .rank-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .rank-1 { background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%); color: white; }
        .rank-2 { background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%); color: white; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32 0%, #a0522d 100%); color: white; }
        .rank-other { background: #ecf0f1; color: #666; font-size: 0.8rem; }

        .rank-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
            flex-shrink: 0;
            overflow: hidden;
        }

        .rank-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .rank-info {
            flex: 1;
            min-width: 0;
        }

        .rank-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .rank-name a {
            color: #2c3e50;
            text-decoration: none;
        }

        .rank-name a:hover {
            color: #7c7fd6;
            text-decoration: underline;
        }

        .rank-score {
            color: #3498db;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .form-label .required {
            color: #e74c3c;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #7c7fd6;
            box-shadow: 0 0 0 3px rgba(124, 127, 214, 0.1);
        }

        .form-input::placeholder {
            color: #aaa;
        }

        .form-hint {
            font-size: 0.8rem;
            color: #888;
            margin-top: 0.25rem;
        }

        .image-upload-container {
            border: 2px dashed #ccc;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }

        .image-upload-container:hover {
            border-color: #7c7fd6;
            background: #f0f0ff;
        }

        .image-upload-container.has-image {
            border-style: solid;
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .image-upload-input {
            display: none;
        }

        .image-upload-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 1rem;
            display: none;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .image-upload-preview.active {
            display: block;
        }

        .image-upload-text {
            color: #666;
            font-size: 0.9rem;
        }

        .image-upload-text .icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .image-upload-change {
            color: #7c7fd6;
            font-size: 0.8rem;
            margin-top: 0.5rem;
            display: none;
        }

        .image-upload-container.has-image .image-upload-change {
            display: block;
        }

        .image-upload-container.has-image .image-upload-text {
            display: none;
        }

        .enter-button-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 1.5rem;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .btn-enter {
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
            color: white;
            border: none;
            padding: 1rem 4rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
            transition: all 0.3s;
            width: 100%;
            max-width: 400px;
        }

        .btn-enter:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.6);
        }

        .btn-enter:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-enter.entered {
            background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
        }

        .btn-leave {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
            transition: all 0.3s;
        }

        .btn-leave:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.6);
        }

        .btn-leave:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 450px;
            width: 100%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlide 0.3s;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .btn-modal {
            padding: 0.75rem 2rem;
            border-radius: 25px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .btn-cancel {
            background: #f0f0f0;
            color: #666;
        }

        .btn-cancel:hover {
            background: #e0e0e0;
        }

        .btn-ok {
            background: #2196f3;
            color: white;
        }

        .btn-ok:hover {
            background: #1976d2;
        }

        .btn-ok-full {
            background: #2196f3;
            color: white;
            padding: 0.875rem 2rem;
            border-radius: 25px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin-top: 0.5rem;
        }

        .btn-ok-full:hover {
            background: #1976d2;
        }

        .btn-ok-full:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .content-spacer {
            height: 100px;
        }

        .alert {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .alert-error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }

        .alert-success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }

        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-family: monospace;
            font-size: 0.8rem;
            text-align: center;
        }

        @media (max-width: 640px) {
            .content-wrapper {
                padding: 1rem;
            }
            
            .tabs {
                font-size: 0.9rem;
            }

            .btn-enter, .btn-leave {
                padding: 0.875rem 1.5rem;
                font-size: 1rem;
            }

            .modal {
                padding: 1.5rem;
            }
            
            .user-rank-position {
                font-size: 1rem;
                min-width: 50px;
            }
        }
    </style>
</head>
<body>

    <!-- Debug Info -->
    <div id="debugInfo" class="debug-info" style="display: none;"></div>

    <!-- Countdown Banner -->
    <div class="countdown-banner">
        Hasta el final del evento: <span class="countdown-time" id="countdown">Cargando...</span>
    </div>

    <!-- Hero Banner -->
    <div class="hero-banner">
        <img src="https://raw.githubusercontent.com/estelarlatam/eventos/refs/heads/main/Informacion/Create-a-Sticker-Gift/contenido-del-evento/%E2%96%A0Banner-del-Evento.png" 
             alt="Create a Sticker Gift Event Banner" 
             onerror="this.style.display='none'; this.parentElement.style.background='linear-gradient(135deg, #ffb6c1 0%, #ffc0cb 100%)'; this.parentElement.innerHTML='<div style=\'padding: 2rem; text-align: center;\'><h1 style=\'color: white; font-size: 2rem;\'>Create a Sticker Gift!</h1></div>';">
    </div>

    <!-- Tabs -->
    <div class="tabs-container">
        <div class="tabs">
            <button class="tab active" onclick="switchTab('details')">Detalles del evento</button>
            <button class="tab" onclick="switchTab('rankings')">Puntuaciones</button>
        </div>
    </div>

    <!-- Content -->
    <div class="content-wrapper">

        <!-- TAB: DETALLES -->
        <div id="details" class="tab-content active">
            
            <!-- Intro Card -->
            <div class="card">
                <p class="card-text">
                    <strong>Los ganadores de este evento obtendr√°n el privilegio exclusivo de dise√±ar un regalo.</strong>
                </p>
                <p class="card-text">
                    ¬°Estos regalos estar√°n disponibles para todos los usuarios en cualquier momento! Obt√©n una alta puntuaci√≥n, ¬°y todos podr√≠an regalar stickers con tu dise√±o original!
                </p>
            </div>

            <!-- Original Gift Image -->
            <div class="card">
                <div class="card-subtitle">IMAGEN DEL REGALO ORIGINAL</div>
                <div class="gift-image-container">
                    <img src="https://content-cf.reality.app/6ead3b317ae2a6f13dd5dbf9190fc02b6212c1b2.png?t=1681363059" 
                         alt="Imagen del regalo original" 
                         onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 300%22><rect fill=%22%23ff6b9d%22 width=%22400%22 height=%22300%22/><text x=%2250%%22 y=%2250%%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2220%22>Imagen del Regalo</text></svg>';">
                </div>
                <p class="disclaimer">*La imagen de arriba es una muestra. El dise√±o y distribuci√≥n real pueden diferir.</p>
            </div>

            <!-- Awards Section -->
            <div class="awards-section">
                <div class="awards-header">
                    <h3>Premios</h3>
                    <div class="subtitle">Streamer</div>
                </div>
                <div class="awards-content">
                    <table class="info-table">
                        <thead>
                            <tr>
                                <th>Condiciones</th>
                                <th>Premios</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Rank 1¬∞ - 3¬∞ y obtener una puntuaci√≥n de evento de 3,000,000 o superior</td>
                                <td>Oportunidad de crear un regalo original basado en una imagen proporcionada por el usuario.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Schedule -->
            <div class="card">
                <h3 class="card-title">Calendario</h3>
                
                <div class="schedule-item">
                    <div class="schedule-title">Per√≠odo de Inscripci√≥n</div>
                    <div class="schedule-date" id="fecha-inscripcion">Cargando...</div>
                    <div class="schedule-note">Nota: Las inscripciones al evento se aceptar√°n hasta el final del per√≠odo del evento.</div>
                </div>

                <div class="schedule-item">
                    <div class="schedule-title">Per√≠odo del Evento</div>
                    <div class="schedule-date" id="fecha-evento">Cargando...</div>
                </div>

                <div class="schedule-item">
                    <div class="schedule-title">Per√≠odo de Distribuci√≥n de Premios</div>
                    <div class="schedule-date">‚ñ†Regalo original: Se lanzar√° aproximadamente 3 meses despu√©s.</div>
                </div>
            </div>

            <!-- Award Details -->
            <div class="card">
                <h3 class="card-title">Detalles de los Premios</h3>
                
                <ul class="details-list">
                    <li>Solo los usuarios que mantengan su configuraci√≥n regional en Global durante todo el per√≠odo del evento son elegibles para recibir premios. Los usuarios que cambien de regi√≥n durante el evento no ser√°n elegibles.</li>
                </ul>

                <div class="section-header">‚ñ†Creaci√≥n de Regalo Original</div>
                <ul class="details-list">
                    <li>Creadores: Usuarios que ocupen del 1¬∞ al 3¬∞ lugar en este evento.</li>
                    <li>Estos usuarios ser√°n notificados antes del 10 de febrero de 2026 a las 23:59 -05 a trav√©s de la pantalla "Chat" en la App Estelar.</li>
                    <li>El nombre del regalo, la imagen base a utilizar y el nombre del creador deben enviarse antes del 22 de febrero de 2026 a las 09:59 -05.</li>
                    <li>A estos usuarios se les pedir√° que presenten un Certificado de transferencia de derechos de la ilustraci√≥n. El incumplimiento resultar√° en la cancelaci√≥n del premio.</li>
                </ul>

                <p style="font-size: 0.85rem; color: #888; margin: 1rem 0; font-style: italic;">
                    Nota: Los usuarios que no est√©n en el top 3 no ser√°n contactados. Gracias por su comprensi√≥n.
                </p>

                <ul class="details-list">
                    <li>Los regalos est√°n programados para lanzarse aproximadamente 3 meses despu√©s.</li>
                    <li>Estos regalos se lanzar√°n como regalos de Monedas.</li>
                    <li>Los regalos ser√°n animados como "GG", "Nos vemos" y "Buenas noches". No puedes designar otros tipos de animaci√≥n.</li>
                    <li>Si no puedes responder a las consultas sobre la creaci√≥n de premios dentro del per√≠odo establecido, tus privilegios de dise√±o de premios pueden ser revocados.</li>
                </ul>

                <div class="section-header">‚ñ†Im√°genes a Utilizar para los Regalos</div>
                
                <div class="gift-examples-real">
                    <img src="https://raw.githubusercontent.com/estelarlatam/eventos/refs/heads/main/Informacion/Create-a-Sticker-Gift/contenido-del-evento/%E2%96%A0Im%C3%A1genes%20para%20usar%20en%20regalos.png" 
                         alt="Im√°genes para usar en regalos" 
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'padding: 2rem; text-align: center; background: #f0f0f0; border-radius: 12px;\'>üëã üåô</div>';">
                </div>

                <ul class="details-list">
                    <li>La imagen debe ser un archivo PNG de 512 x 512px con fondo transparente.</li>
                    <li>La imagen debe ser un archivo PNG de 512 x 512px con fondo transparente.</li>
                    <li>El borde blanco y la sombra ser√°n preparados por nuestro equipo de dise√±o.</li>
                    <li>No se permiten im√°genes que infrinjan derechos de autor, marcas registradas o que contengan contenido inapropiado.</li>
                    <li>La imagen debe ser original y creada por el usuario ganador.</li>
                </ul>

                <div class="section-header">‚ñ†Distribuci√≥n de Ganancias</div>
                <ul class="details-list">
                    <li>Los creadores recibir√°n un porcentaje de las ganancias cada vez que su regalo sea enviado.</li>
                    <li>El porcentaje exacto ser√° detallado en el contrato enviado a los ganadores.</li>
                    <li>Las ganancias se acumular√°n en la cuenta del creador y se podr√°n retirar mensualmente.</li>
                </ul>
            </div>

            <!-- FAQ Accordion -->
            <div class="accordion-container">
                <div class="accordion-header">Preguntas Frecuentes</div>
                
                <div class="accordion-item">
                    <button class="accordion-trigger" onclick="toggleAccordion(this)">
                        ¬øQui√©n puede participar en este evento?
                        <span class="accordion-icon">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            Cualquier usuario con configuraci√≥n regional en Global puede participar. Los usuarios que cambien su regi√≥n durante el evento no ser√°n elegibles para premios.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-trigger" onclick="toggleAccordion(this)">
                        ¬øC√≥mo se calcula la puntuaci√≥n del evento?
                        <span class="accordion-icon">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            La puntuaci√≥n se basa en la cantidad total de regalos recibidos durante el per√≠odo del evento. Solo los regalos enviados durante el evento cuentan para la puntuaci√≥n.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-trigger" onclick="toggleAccordion(this)">
                        ¬øPuedo editar mi regalo despu√©s de enviarlo?
                        <span class="accordion-icon">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            Una vez aprobado el dise√±o del regalo, no se permiten cambios mayores. Correcciones menores pueden ser solicitadas dentro de las 48 horas posteriores a la aprobaci√≥n.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-trigger" onclick="toggleAccordion(this)">
                        ¬øQu√© pasa si no respondo a tiempo?
                        <span class="accordion-icon">‚ñº</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            Si no respondes a las consultas sobre la creaci√≥n de premios dentro del per√≠odo establecido (antes del 22 de febrero), tus privilegios de dise√±o de premios pueden ser revocados y otorgados al siguiente participante en el ranking.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB: RANKINGS -->
        <div id="rankings" class="tab-content">
            
            <!-- User Ranking Card -->
            <div class="user-ranking-card" id="userRanking" style="display: none;">
                <div class="user-rank-position" id="userRank">--</div>
                <div class="user-avatar" id="userAvatar">
                    <span id="userInitial">?</span>
                    <img id="userAvatarImg" style="display: none;" alt="Avatar">
                </div>
                <div class="user-info">
                    <div class="user-name">
                        <a href="#" id="userNameLink">Tu Nombre</a>
                        <span class="verified-badge" id="verifiedBadge" style="display: none;">‚úì</span>
                    </div>
                    <div class="user-score" id="userScore">0 puntos</div>
                </div>
            </div>

            <!-- Not Participating Message -->
            <div class="card" id="notParticipatingMsg" style="text-align: center; padding: 2rem;">
                <p style="color: #666; margin-bottom: 1rem;">A√∫n no participas en este evento</p>
                <p style="font-size: 0.9rem; color: #888;">√önete para aparecer en el ranking</p>
            </div>

            <!-- Rankings Header -->
            <div class="rankings-header">
                <span>üèÜ</span>
                <span>Clasificaci√≥n General</span>
                <span class="participant-count">
                    <span>üë•</span>
                    <span id="participantCount">0 participantes</span>
                </span>
            </div>

            <!-- Ranking List -->
            <div class="ranking-list" id="rankingList">
                <div class="ranking-item" style="justify-content: center; color: #888; padding: 2rem;">
                    Cargando clasificaci√≥n...
                </div>
            </div>

            <!-- Pagination -->
            <div style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap;">
                <button class="btn-cancel" onclick="changePage(-1)" style="padding: 0.5rem 1rem;">‚Üê Anterior</button>
                <span id="pageIndicator" style="padding: 0.5rem 1rem; color: #666; font-weight: 600;">P√°gina 1</span>
                <button class="btn-cancel" onclick="changePage(1)" style="padding: 0.5rem 1rem;">Siguiente ‚Üí</button>
            </div>
        </div>

        <div class="content-spacer"></div>
    </div>

    <!-- Fixed Button Container -->
    <div class="enter-button-container" id="buttonContainer">
        <button class="btn-enter" id="enterBtn" onclick="showEnterModal()">
            Participar en el Evento
        </button>
    </div>

    <!-- Enter Event Modal -->
    <div class="modal-overlay" id="enterModal">
        <div class="modal">
            <h3 class="modal-title">üéâ √önete al Evento</h3>
            
            <!-- Image Upload -->
            <div class="form-group" style="text-align: center;">
                <div class="image-upload-container" id="uploadContainer" onclick="document.getElementById('fileInput').click()">
                    <img class="image-upload-preview" id="uploadPreview" alt="Preview">
                    <div class="image-upload-text">
                        <span class="icon">üì∑</span>
                        Foto de Perfil (Opcional)<br>
                        <small style="color: #999;">Toca para subir una foto</small>
                    </div>
                    <div class="image-upload-change">Cambiar imagen</div>
                </div>
                <input type="file" class="image-upload-input" id="fileInput" accept="image/jpeg,image/png,image/jpg" onchange="handleFileSelect(event)">
                <p class="form-hint">Formatos: JPG, PNG. M√°ximo 2MB</p>
            </div>

            <!-- Username -->
            <div class="form-group">
                <label class="form-label">Nombre de Usuario <span class="required">*</span></label>
                <input type="text" class="form-input" id="regUsername" placeholder="Tu nombre de usuario" required>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label class="form-label">Correo Electr√≥nico <span class="required">*</span></label>
                <input type="email" class="form-input" id="regEmail" placeholder="tu@email.com" required>
            </div>

            <!-- Profile Link -->
            <div class="form-group">
                <label class="form-label">Link del Perfil <span class="required">*</span></label>
                <input type="url" class="form-input" id="regProfileLink" placeholder="https://estelar.app/usuario" required>
                <p class="form-hint">URL completa de tu perfil en Estelar</p>
            </div>

            <div style="margin-top: 1.5rem;">
                <button class="btn-ok-full" onclick="confirmEnter()" id="confirmEnterBtn">
                    <span id="enterSpinner" class="spinner" style="display: none;"></span>
                    <span id="enterText">Confirmar Registro</span>
                </button>
                <button class="btn-cancel" onclick="closeModal('enterModal')" style="margin-top: 0.5rem; width: 100%; padding: 0.75rem;">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Leave Event Modal -->
    <div class="modal-overlay" id="leaveModal">
        <div class="modal">
            <h3 class="modal-title">‚ö†Ô∏è ¬øAbandonar el evento?</h3>
            <p style="color: #666; margin-bottom: 1.5rem; line-height: 1.5;">
                Si abandonas el evento, perder√°s toda tu puntuaci√≥n acumulada y no podr√°s recuperarla. ¬øEst√°s seguro?
            </p>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" onclick="closeModal('leaveModal')">Cancelar</button>
                <button class="btn-modal btn-ok" onclick="confirmLeave()" id="confirmLeaveBtn" style="background: #f44336;">
                    <span id="leaveSpinner" class="spinner" style="display: none;"></span>
                    <span id="leaveText">Abandonar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal">
        <div class="modal">
            <div style="font-size: 3rem; margin-bottom: 1rem;">‚úÖ</div>
            <h3 class="modal-title" id="successTitle">¬°√âxito!</h3>
            <p style="color: #666; margin-bottom: 1.5rem;" id="successMessage">Operaci√≥n completada correctamente.</p>
            <button class="btn-ok-full" onclick="closeModal('successModal')">Aceptar</button>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal">
            <div style="font-size: 3rem; margin-bottom: 1rem;">‚ùå</div>
            <h3 class="modal-title" id="errorTitle">Error</h3>
            <p style="color: #666; margin-bottom: 1.5rem;" id="errorMessage">Ha ocurrido un error.</p>
            <button class="btn-ok-full" onclick="closeModal('errorModal')" style="background: #f44336;">Aceptar</button>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACI√ìN - REEMPLAZA ESTA URL
        // ==========================================
        
        const CONFIG = {
            // REEMPLAZA con tu URL real de Apps Script (debe terminar en /exec)
            APPS_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbwjyFMctwPETIefCt3YoItKTgP9VaSPMGcopRBxy0yUcb7k4xpPlfZjldWZCi075loJtQ/exec',
            EVENT_NAME: 'Create-a-Sticker-Gift'
        };

        const EVENT_CONFIG = {
            registrationStart: new Date('2025-01-15T00:00:00-05:00'),
            registrationEnd: new Date('2025-02-10T23:59:59-05:00'),
            eventStart: new Date('2025-01-20T00:00:00-05:00'),
            eventEnd: new Date('2025-02-10T23:59:59-05:00')
        };

        // ==========================================
        // ESTADO
        // ==========================================
        
        let userState = {
            isParticipating: false,
            userEmail: null,
            userData: null,
            currentPage: 1,
            itemsPerPage: 10,
            allParticipants: []
        };

        // ==========================================
        // INICIALIZACI√ìN
        // ==========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeDates();
            startCountdown();
            loadUserFromStorage();
            
            // Verificar URL configurada
            if (CONFIG.APPS_SCRIPT_URL.includes('XXXXXXXX') || CONFIG.APPS_SCRIPT_URL === '') {
                showDebug('‚ö†Ô∏è ERROR: Configura APPS_SCRIPT_URL en el c√≥digo JavaScript');
                document.getElementById('rankingList').innerHTML = 
                    '<div class="ranking-item" style="justify-content: center; color: #e74c3c; padding: 2rem;">Error: URL no configurada</div>';
            } else {
                fetchParticipantsJSONP();
            }
        });

        function showDebug(msg) {
            const el = document.getElementById('debugInfo');
            el.textContent = msg;
            el.style.display = 'block';
            console.error(msg);
        }

        // ==========================================
        // FECHAS
        // ==========================================
        
        function formatDate(date) {
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZoneName: 'short'
            };
            return date.toLocaleDateString('es-ES', options);
        }

        function initializeDates() {
            document.getElementById('fecha-inscripcion').textContent = 
                `${formatDate(EVENT_CONFIG.registrationStart)} - ${formatDate(EVENT_CONFIG.registrationEnd)}`;
            document.getElementById('fecha-evento').textContent = 
                `${formatDate(EVENT_CONFIG.eventStart)} - ${formatDate(EVENT_CONFIG.eventEnd)}`;
        }

        function startCountdown() {
            function update() {
                const now = new Date();
                const end = EVENT_CONFIG.eventEnd;
                const diff = end - now;

                if (diff <= 0) {
                    document.getElementById('countdown').innerHTML = '<span class="event-ended">Evento Finalizado</span>';
                    document.getElementById('enterBtn').disabled = true;
                    document.getElementById('enterBtn').textContent = 'Evento Finalizado';
                    return;
                }

                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('countdown').textContent = `${d}d ${h}h ${m}m ${s}s`;
            }
            update();
            setInterval(update, 1000);
        }

        // ==========================================
        // UTILIDADES
        // ==========================================
        
        function getOrdinal(n) {
            const s = ["th", "st", "nd", "rd"];
            const v = n % 100;
            return n + (s[(v - 20) % 10] || s[v] || s[0]);
        }

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        // ==========================================
        // UI
        // ==========================================
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'rankings') renderRanking();
        }

        function toggleAccordion(btn) {
            const item = btn.parentElement;
            const isActive = item.classList.contains('active');
            
            document.querySelectorAll('.accordion-item').forEach(a => a.classList.remove('active'));
            if (!isActive) item.classList.add('active');
        }

        function showEnterModal() {
            if (userState.isParticipating) return;
            document.getElementById('enterModal').classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        function showSuccess(title, msg) {
            document.getElementById('successTitle').textContent = title;
            document.getElementById('successMessage').textContent = msg;
            document.getElementById('successModal').classList.add('active');
        }

        function showError(title, msg) {
            document.getElementById('errorTitle').textContent = title;
            document.getElementById('errorMessage').textContent = msg;
            document.getElementById('errorModal').classList.add('active');
        }

        // ==========================================
        // ARCHIVOS
        // ==========================================
        
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            if (file.size > 2 * 1024 * 1024) {
                showError('Archivo muy grande', 'M√°ximo 2MB permitido');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(evt) {
                document.getElementById('uploadPreview').src = evt.target.result;
                document.getElementById('uploadPreview').classList.add('active');
                document.getElementById('uploadContainer').classList.add('has-image');
                userState.tempImage = evt.target.result;
            };
            reader.readAsDataURL(file);
        }

        // ==========================================
        // JSONP - CARGAR PARTICIPANTES (M√âTODO CONFIABLE)
        // ==========================================
        
        function fetchParticipantsJSONP() {
            const script = document.createElement('script');
            const callbackName = 'jsonpCallback_' + Date.now();
            
            window[callbackName] = function(data) {
                console.log('Datos recibidos:', data);
                
                if (data.success) {
                    userState.allParticipants = data.participants || [];
                    document.getElementById('participantCount').textContent = 
                        `${data.count || 0} participantes`;
                    
                    // Actualizar usuario si participa
                    if (userState.isParticipating && userState.userEmail) {
                        const user = userState.allParticipants.find(p => p.email === userState.userEmail);
                        if (user) {
                            userState.userData = user;
                            updateUserCard();
                        }
                    }
                    
                    renderRanking();
                } else {
                    showDebug('Error del servidor: ' + (data.error || 'Desconocido'));
                    document.getElementById('rankingList').innerHTML = 
                        '<div class="ranking-item" style="justify-content: center; color: #888; padding: 2rem;">Error cargando datos</div>';
                }
                
                // Limpiar
                delete window[callbackName];
                document.head.removeChild(script);
            };
            
            script.src = `${CONFIG.APPS_SCRIPT_URL}?action=getParticipants&evento=${encodeURIComponent(CONFIG.EVENT_NAME)}&callback=${callbackName}`;
            script.onerror = function() {
                showDebug('Error: No se pudo cargar el script. Verifica la URL.');
                document.getElementById('rankingList').innerHTML = 
                    '<div class="ranking-item" style="justify-content: center; color: #e74c3c; padding: 2rem;">Error de conexi√≥n</div>';
                delete window[callbackName];
            };
            
            document.head.appendChild(script);
        }

        // ==========================================
        // REGISTRO (POST)
        // ==========================================
        
        async function confirmEnter() {
            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const profileLink = document.getElementById('regProfileLink').value.trim();
            
            if (!username || !email || !profileLink) {
                showError('Campos incompletos', 'Completa todos los campos obligatorios');
                return;
            }
            
            if (!email.includes('@')) {
                showError('Email inv√°lido', 'Ingresa un correo v√°lido');
                return;
            }
            
            const btn = document.getElementById('confirmEnterBtn');
            const spinner = document.getElementById('enterSpinner');
            const text = document.getElementById('enterText');
            
            btn.disabled = true;
            spinner.style.display = 'inline-block';
            text.textContent = 'Registrando...';
            
            try {
                const response = await fetch(CONFIG.APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'text/plain;charset=utf-8'},
                    body: JSON.stringify({
                        action: 'join',
                        username, email, profileLink,
                        evento: CONFIG.EVENT_NAME,
                        profileImage: userState.tempImage || ''
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    userState.isParticipating = true;
                    userState.userEmail = email;
                    userState.userData = {
                        username, email, profileLink,
                        profileImage: result.imageUrl || '',
                        score: 0
                    };
                    
                    saveUserToStorage();
                    updateUIForParticipant();
                    closeModal('enterModal');
                    showSuccess('¬°Bienvenido!', 'Registro exitoso. ¬°Mucha suerte!');
                    fetchParticipantsJSONP();
                } else {
                    showError('Error', result.error || 'No se pudo completar el registro');
                }
                
            } catch (error) {
                console.error(error);
                showError('Error de conexi√≥n', 'No se pudo conectar con el servidor');
            } finally {
                btn.disabled = false;
                spinner.style.display = 'none';
                text.textContent = 'Confirmar Registro';
            }
        }

        // ==========================================
        // SALIR
        // ==========================================
        
        async function confirmLeave() {
            const btn = document.getElementById('confirmLeaveBtn');
            const spinner = document.getElementById('leaveSpinner');
            const text = document.getElementById('leaveText');
            
            btn.disabled = true;
            spinner.style.display = 'inline-block';
            text.textContent = 'Procesando...';
            
            try {
                const response = await fetch(CONFIG.APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'text/plain;charset=utf-8'},
                    body: JSON.stringify({
                        action: 'leave',
                        email: userState.userEmail,
                        evento: CONFIG.EVENT_NAME
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    userState.isParticipating = false;
                    userState.userData = null;
                    removeUserFromStorage();
                    updateUIForNonParticipant();
                    closeModal('leaveModal');
                    showSuccess('Evento Abandonado', 'Has salido del evento');
                    fetchParticipantsJSONP();
                } else {
                    showError('Error', result.error || 'No se pudo procesar');
                }
                
            } catch (error) {
                showError('Error de conexi√≥n', 'No se pudo conectar');
            } finally {
                btn.disabled = false;
                spinner.style.display = 'none';
                text.textContent = 'Abandonar';
            }
        }

        // ==========================================
        // ACTUALIZAR UI
        // ==========================================
        
        function updateUIForParticipant() {
            const btn = document.getElementById('enterBtn');
            btn.classList.add('entered');
            btn.textContent = '‚úì Participando';
            btn.disabled = true;
            
            if (!document.getElementById('leaveBtn')) {
                const leaveBtn = document.createElement('button');
                leaveBtn.id = 'leaveBtn';
                leaveBtn.className = 'btn-leave';
                leaveBtn.textContent = 'Abandonar';
                leaveBtn.onclick = () => document.getElementById('leaveModal').classList.add('active');
                document.getElementById('buttonContainer').appendChild(leaveBtn);
            }
            
            document.getElementById('notParticipatingMsg').style.display = 'none';
            document.getElementById('userRanking').style.display = 'flex';
            updateUserCard();
        }

        function updateUIForNonParticipant() {
            const btn = document.getElementById('enterBtn');
            const leaveBtn = document.getElementById('leaveBtn');
            
            btn.classList.remove('entered');
            btn.textContent = 'Participar en el Evento';
            btn.disabled = false;
            
            if (leaveBtn) leaveBtn.remove();
            
            document.getElementById('notParticipatingMsg').style.display = 'block';
            document.getElementById('userRanking').style.display = 'none';
        }

        function updateUserCard() {
            if (!userState.isParticipating || !userState.userData) return;
            
            const user = userState.userData;
            const sorted = [...userState.allParticipants].sort((a, b) => b.score - a.score);
            const position = sorted.findIndex(p => p.email === user.email) + 1;
            
            document.getElementById('userRank').textContent = getOrdinal(position);
            document.getElementById('userNameLink').textContent = user.username;
            document.getElementById('userScore').textContent = `${formatNumber(user.score)} puntos`;
            
            const img = document.getElementById('userAvatarImg');
            const initial = document.getElementById('userInitial');
            
            if (user.profileImage) {
                img.src = user.profileImage;
                img.style.display = 'block';
                initial.style.display = 'none';
            } else {
                img.style.display = 'none';
                initial.style.display = 'block';
                initial.textContent = user.username.charAt(0).toUpperCase();
            }
        }

        // ==========================================
        // RENDERIZAR RANKING
        // ==========================================
        
        function renderRanking() {
            const list = document.getElementById('rankingList');
            
            if (!userState.allParticipants || userState.allParticipants.length === 0) {
                list.innerHTML = `
                    <div class="ranking-item" style="flex-direction: column; align-items: center; color: #888; padding: 2rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìã</div>
                        <div>No hay participantes a√∫n</div>
                    </div>
                `;
                return;
            }
            
            const start = (userState.currentPage - 1) * userState.itemsPerPage;
            const end = start + userState.itemsPerPage;
            const pageData = userState.allParticipants.slice(start, end);
            
            list.innerHTML = pageData.map((user, index) => {
                const actualRank = start + index + 1;
                const rankClass = actualRank === 1 ? 'rank-1' : 
                                 actualRank === 2 ? 'rank-2' : 
                                 actualRank === 3 ? 'rank-3' : 'rank-other';
                
                const avatarContent = user.profileImage ? 
                    `<img src="${user.profileImage}" alt="${user.username}" onerror="this.style.display='none'; this.parentElement.textContent='${user.username.charAt(0).toUpperCase()}'">` : 
                    user.username.charAt(0).toUpperCase();
                
                return `
                    <div class="ranking-item">
                        <div class="rank-number ${rankClass}">${actualRank}</div>
                        <div class="rank-avatar">${avatarContent}</div>
                        <div class="rank-info">
                            <div class="rank-name">
                                <a href="${user.profileLink}" target="_blank">${user.username}</a>
                            </div>
                        </div>
                        <div class="rank-score">${formatNumber(user.score)} pts</div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('pageIndicator').textContent = `P√°gina ${userState.currentPage}`;
        }

        function changePage(dir) {
            const maxPage = Math.ceil(userState.allParticipants.length / userState.itemsPerPage);
            const newPage = userState.currentPage + dir;
            
            if (newPage >= 1 && newPage <= maxPage) {
                userState.currentPage = newPage;
                renderRanking();
            }
        }

        // ==========================================
        // STORAGE
        // ==========================================
        
        function saveUserToStorage() {
            localStorage.setItem('stickerEvent_user', JSON.stringify({
                email: userState.userEmail,
                isParticipating: userState.isParticipating
            }));
        }

        function loadUserFromStorage() {
            const saved = localStorage.getItem('stickerEvent_user');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    userState.userEmail = data.email;
                    userState.isParticipating = data.isParticipating;
                    if (userState.isParticipating) updateUIForParticipant();
                } catch (e) {
                    console.error(e);
                }
            }
        }

        function removeUserFromStorage() {
            localStorage.removeItem('stickerEvent_user');
        }

        // Cerrar modales al hacer click fuera
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) this.classList.remove('active');
            });
        });
    </script>
</body>
</html>
